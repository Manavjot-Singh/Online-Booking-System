{% load static %}
<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Albany Airlines</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO"
      crossorigin="anonymous"
    ></script>

    <header class="d-flex justify-content-center py-3 mb-4 border-bottom">
      <a
        href="{% url 'home' %}"
        class="d-flex align-items-center me-md-auto text-decoration-none ps-3"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="28"
          height="28"
          fill="currentColor"
          class="me-3"
          viewBox="0 0 16 16"
        >
          <path
            d="M6.428 1.151C6.708.591 7.213 0 8 0s1.292.592
             1.572 1.151C9.861 1.73 10 2.431 10 3v3.691l5.17
             2.585a1.5 1.5 0 0 1 .83 1.342V12a.5.5 0 0
             1-.582.493l-5.507-.918-.375 2.253 1.318
             1.318A.5.5 0 0 1 10.5 16h-5a.5.5 0 0
             1-.354-.854l1.319-1.318-.376-2.253-5.507.918A.5.5
             0 0 1 0 12v-1.382a1.5 1.5 0 0 1 .83-1.342L6
             6.691V3c0-.568.14-1.271.428-1.849"
          />
        </svg>
        <span class="fs-3">Albany Airlines</span>
      </a>
      <ul class="nav nav-pills">
        <li class="nav-item">
          <a href="{% url 'home' %}" class="nav-link active">Home</a>
        </li>
        <li class="nav-item">
          <a href="{% url 'search' %}" class="nav-link">Search</a>
        </li>
        <li class="nav-item">
          <a href="{% url 'about' %}" class="nav-link">About</a>
        </li>
        <li class="nav-item">
          <a href="{% url 'booking_lookup' %}" class="nav-link">Find</a>
        </li>
      </ul>
    </header>

    <div class="container col-xl-10 col-xxl-8 px-4 py-5">
      <div class="row align-items-center g-lg-5 py-5">
        <div class="col-lg-7 text-center text-lg-start">
          <h1 class="display-4 fw-bold lh-1 mb-3">
            Book your flight with Albany Airlines
          </h1>
          <p class="col-lg-10 fs-4">
            Book your flight with Albany Airlines and enjoy a comfortable and
            safe journey. We offer a wide range of destinations and services to
            make your travel experience unforgettable. Whether you're flying for
            business or leisure, we have the perfect flight for you.
          </p>
        </div>
        <div class="col-md-10 mx-auto col-lg-5">
          <form
            method="get"
            action="{% url 'search' %}"
            class="p-4 p-md-5 border rounded-3 bg-body-tertiary"
          >
            <div class="form-floating mb-3">
              <input
                type="text"
                class="form-control"
                name="origin"
                placeholder="NZNE"
                value="{{ origin }}"
                required
              />
              <label for="origin">Origin</label>
            </div>
            <div class="form-floating mb-3">
              <input
                type="text"
                class="form-control"
                name="destination"
                placeholder="NZRO"
                value="{{ destination }}"
                required
              />
              <label for="destination">Destination</label>
            </div>
            <div class="form-floating mb-3">
              <input
                type="date"
                class="form-control"
                name="date"
                value="{{ date }}"
                required
              />
              <label for="date">Date</label>
            </div>
            <button class="w-100 btn btn-lg btn-primary" type="submit">
              Search
            </button>
          </form>
        </div>
      </div>
    </div>

    {% if flights is not None %} {% if flights %}
    <div class="container py-4">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Flight #</th>
            <th>Departure(local)</th>
            <th>Arrival(local)</th>
            <th>Seats Left</th>
            <th>Price (NZD)</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          {% for flight in flights %}
          <tr>
            <td>{{ flight.flight.schedule.flight_number }}</td>
            <td>{{ flight.dep_time|date:"g:i A" }}</td>
            <td>{{ flight.arr_time|date:"g:i A" }}</td>
            <td>{{ flight.flight.seats_available }}</td>
            <td>{{ flight.flight.schedule.price }}</td>
            <td>
              {% if flight.flight.seats_available > 0 %}
              <a
                href="{% url 'book' flight.flight.id %}"
                class="btn btn-success btn-sm"
                >Book</a
              >
              {% else %}
              <button class="btn btn-secondary btn-sm" disabled>
                Sold out
              </button>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="alert alert-warning text-center">
      No flights found for {{ origin }} → {{ destination }} on {{ date }}.
    </div>
    {% endif %} {% endif %}
  </body>
</html>
